<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Component Library Demo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="favicon" type="image/x-icon">
</head>

<body>
    <!-- Navigation -->
    <header>
        <nav class="nav">
            <a href="#" class="nav-link">Home</a>
            <a href="#" class="nav-link active">Components</a>
            <a href="#" class="nav-link">Documentation</a>
            <a href="#" class="nav-link">Contact</a>
        </nav>
    </header>
    <div class="page-layout container mt-3">

        <!-- Table of Contents Sidebar -->
        <aside class="sidebar">
            <ul class="toc-list">
                <li><a href="#alerts" class="toc-link">Alerts</a></li>
                <li><a href="#buttons" class="toc-link">Buttons</a></li>
                <li><a href="#forms" class="toc-link">Form Elements</a></li>
                <li><a href="#three-col" class="toc-link">Three Column Layout</a></li>
                <li><a href="#two-col" class="toc-link">Two Column Layout</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <!-- Alerts Section -->
            <section id="alerts">
                <h2 class="section-title">Alerts</h2>
                <div class="alert alert-success">
                    <i data-lucide="check-circle"></i>
                    This is a success alert — check it out!
                </div>
                <div class="alert alert-warning">
                    <i data-lucide="circle-alert"></i>
                    This is a warning alert — check it out!
                </div>
                <div class="alert alert-danger">
                    <i data-lucide="octagon-x"></i>
                    This is a danger alert — check it out!
                </div>
            </section>

            <!-- Buttons Section -->
            <section id="buttons">
                <h2 class="section-title">Buttons</h2>
                <div class="flex-row">
                    <button class="btn btn-primary">Primary Button</button>
                    <button class="btn btn-secondary">Secondary Button</button>
                    <button class="btn btn-tertiary">Tertiary Button</button>
                    <button class="btn btn-success"><i data-lucide="check"></i><span>Success
                            Button</span></button>
                    <button class="btn btn-warning"><i data-lucide="triangle-alert"></i>Warning Button</button>
                    <button class="btn btn-danger"><i data-lucide="x"></i>Danger Button</button>
                    <button class="btn btn-primary" disabled>Disabled Button</button>
                </div>
            </section>

            <!-- Forms Section -->
            <section id="forms">
                <h2 class="section-title">Form Elements</h2>
                <div class="card">
                    <form>
                        <div class="form-group">
                            <label class="form-label">Name<span class="form-label--required">*</span></label>
                            <input type="text" class="form-input" placeholder="Enter your name" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email<span class="form-label--required">*</span></label>
                            <input type="email" class="form-input" placeholder="Enter your email" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Message<span class="form-label--required">*</span></label>
                            <textarea class="form-input" rows="3" placeholder="Enter your message" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit<i
                                data-lucide="send-horizontal"></i></button>
                    </form>
                </div>
            </section>

            <!-- Flex Layout System -->
            <section id="three-col">
                <h2 class="section-title">Three Column Layout</h2>
                <div class="flex-row">
                    <div class="flex-col-3 card">
                        <div class="card-header">Card 1</div>
                        <div class="card-body">
                            This is a card in a 3-column flex layout. It will stack on mobile devices.
                        </div>
                    </div>
                    <div class="flex-col-3 card">
                        <div class="card-header">Card 2</div>
                        <div class="card-body">
                            This is a card in a 3-column flex layout. It will stack on mobile devices.
                        </div>
                    </div>
                    <div class="flex-col-3 card">
                        <div class="card-header">Card 3</div>
                        <div class="card-body">
                            This is a card in a 3-column flex layout. It will stack on mobile devices.
                        </div>
                    </div>
                </div>
            </section>

            <!-- Two Column Layout -->
            <section id="two-col">
                <h2 class="section-title">Two Column Layout</h2>
                <div class="flex-row">
                    <div class="flex-col-2 card">
                        <div class="card-header">Left Column</div>
                        <div class="card-body">
                            This is the left column in a 2-column flex layout.
                        </div>
                    </div>
                    <div class="flex-col-2 card">
                        <div class="card-header">Right Column</div>
                        <div class="card-body">
                            This is the right column in a 2-column flex layout.
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    <footer class="mt-3"><i data-lucide="rabbit"></i>NimbleKit Component Library</footer>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        lucide.createIcons();

        // Get all sections and TOC links
        const sections = document.querySelectorAll('section');
        const tocLinks = document.querySelectorAll('.toc-link');

        // Configuration for scan zone
        let SCAN_ZONE_HEIGHT = window.innerHeight * 0.2; // 25% of viewport height

        // Add smooth scrolling to TOC links
        tocLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href');
                document.querySelector(targetId).scrollIntoView({ behavior: 'smooth' });
            });
        });

        // Function to calculate how much of an element is in the scan zone
        function getOverlapPercentage(element) {
            const rect = element.getBoundingClientRect();
            const currentScrollY = window.scrollY;

            // Calculate scan zone boundaries
            const scrollPercent = currentScrollY / (document.documentElement.scrollHeight - window.innerHeight);
            const maxTop = window.innerHeight - SCAN_ZONE_HEIGHT;
            const scanZoneTop = maxTop * scrollPercent;
            const scanZoneBottom = scanZoneTop + SCAN_ZONE_HEIGHT;

            // Calculate element boundaries in viewport coordinates
            const elementTop = rect.top;
            const elementBottom = rect.bottom;
            const elementHeight = rect.height;

            // Calculate overlap
            const overlapTop = Math.max(elementTop, scanZoneTop);
            const overlapBottom = Math.min(elementBottom, scanZoneBottom);
            const overlapHeight = Math.max(0, overlapBottom - overlapTop);

            // Calculate percentage of element that's in the scan zone
            return (overlapHeight / elementHeight) * 100;
        }

        // Function to update active section
        function updateActiveSection() {
            // Update scan zone indicator
            //updateScanZoneIndicator(SCAN_ZONE_HEIGHT);

            // Find section with highest overlap percentage
            let maxOverlap = 0;
            let activeSection = null;

            sections.forEach(section => {
                const overlapPercentage = getOverlapPercentage(section);
                if (overlapPercentage > maxOverlap) {
                    maxOverlap = overlapPercentage;
                    activeSection = section;
                }
            });

            // Only activate if we have significant overlap (e.g., more than 10%)
            if (activeSection && maxOverlap > 10) {
                tocLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${activeSection.id}`) {
                        link.classList.add('active');
                    }
                });
            }
        }

        // Create visual indicator of scan zone for debugging
        function createScanZoneIndicator() {
            let indicator = document.getElementById('scan-zone-indicator');
            if (!indicator) {
                indicator = document.createElement('div');
                indicator.id = 'scan-zone-indicator';
                indicator.style.position = 'fixed';
                indicator.style.right = '0';
                indicator.style.width = '20px';
                indicator.style.backgroundColor = 'rgba(255, 0, 0, 0.2)';
                indicator.style.pointerEvents = 'none';
                indicator.style.zIndex = '9999';
                document.body.appendChild(indicator);
            }
            return indicator;
        }

        // Update scan zone indicator position
        function updateScanZoneIndicator(height) {
            const indicator = createScanZoneIndicator();
            const scrollPercent = window.scrollY / (document.documentElement.scrollHeight - window.innerHeight);
            const maxTop = window.innerHeight - height;
            const top = maxTop * scrollPercent;

            indicator.style.top = `${top}px`;
            indicator.style.height = `${height}px`;
        }

        // Add scroll event listener with throttling
        let isThrottled = false;
        const throttleTime = 100;

        window.addEventListener('scroll', () => {
            if (!isThrottled) {
                isThrottled = true;
                setTimeout(() => {
                    updateActiveSection();
                    isThrottled = false;
                }, throttleTime);
            }
        });

        // Add resize event listener
        window.addEventListener('resize', () => {
            // Update scan zone height if viewport changes
            SCAN_ZONE_HEIGHT = window.innerHeight * 0.25;
            updateActiveSection();
        });

        // Initial call to set active section on page load
        updateActiveSection();
    </script>
</body>

</html>